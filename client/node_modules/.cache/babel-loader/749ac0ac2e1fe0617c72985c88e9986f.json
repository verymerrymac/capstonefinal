{"ast":null,"code":"// dumpster-dive throws everything into mongodb  - github.com/spencermountain/dumpster-dive\n// mongo has some opinions about what characters are allowed as keys and ids.\n//https://stackoverflow.com/questions/12397118/mongodb-dot-in-key-name/30254815#30254815\nvar specialChar = /[\\\\\\.$]/;\n\nvar encodeStr = function encodeStr(str) {\n  if (typeof str !== 'string') {\n    str = '';\n  }\n\n  str = str.replace(/\\\\/g, '\\\\\\\\');\n  str = str.replace(/^\\$/, \"\\\\u0024\");\n  str = str.replace(/\\./g, \"\\\\u002e\");\n  return str;\n};\n\nvar encodeObj = function encodeObj() {\n  var obj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var keys = Object.keys(obj);\n\n  for (var i = 0; i < keys.length; i += 1) {\n    if (specialChar.test(keys[i]) === true) {\n      var str = encodeStr(keys[i]);\n\n      if (str !== keys[i]) {\n        obj[str] = obj[keys[i]];\n        delete obj[keys[i]];\n      }\n    }\n  }\n\n  return obj;\n};\n\nmodule.exports = {\n  encodeObj: encodeObj\n};","map":null,"metadata":{},"sourceType":"script"}