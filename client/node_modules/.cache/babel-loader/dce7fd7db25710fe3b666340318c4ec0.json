{"ast":null,"code":"var fns = require('../_lib/helpers');\n\nvar parseSentence = require('../04-sentence/').oneSentence;\n\nvar parseReferences = require('./reference/');\n\nvar heading_reg = /^(={1,5})(.{1,200}?)={1,5}$/; //interpret depth, title of headings like '==See also=='\n\nvar parseHeading = function parseHeading(data, str) {\n  var heading = str.match(heading_reg);\n\n  if (!heading) {\n    data.title = '';\n    data.depth = 0;\n    return data;\n  }\n\n  var title = heading[2] || '';\n  title = parseSentence(title).text(); //amazingly, you can see inline {{templates}} in this text, too\n  //... let's not think about that now.\n\n  title = title.replace(/\\{\\{.+?\\}\\}/, ''); //same for references (i know..)\n\n  title = parseReferences(title, {}); //TODO: this is ridiculous\n  //trim leading/trailing whitespace\n\n  title = fns.trim_whitespace(title);\n  var depth = 0;\n\n  if (heading[1]) {\n    depth = heading[1].length - 2;\n  }\n\n  data.title = title;\n  data.depth = depth;\n  return data;\n};\n\nmodule.exports = parseHeading;","map":null,"metadata":{},"sourceType":"script"}