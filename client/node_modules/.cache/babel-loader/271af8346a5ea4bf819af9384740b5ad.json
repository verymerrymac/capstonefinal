{"ast":null,"code":"var tableParser = require('../table/parse');\n\nvar keys = {\n  coach: ['team', 'year', 'g', 'w', 'l', 'w-l%', 'finish', 'pg', 'pw', 'pl', 'pw-l%'],\n  player: ['year', 'team', 'gp', 'gs', 'mpg', 'fg%', '3p%', 'ft%', 'rpg', 'apg', 'spg', 'bpg', 'ppg'],\n  roster: ['player', 'gp', 'gs', 'mpg', 'fg%', '3fg%', 'ft%', 'rpg', 'apg', 'spg', 'bpg', 'ppg']\n}; //https://en.wikipedia.org/wiki/Template:NBA_player_statistics_start\n\nvar parseNBA = function parseNBA(wiki, section) {\n  wiki = wiki.replace(/\\{\\{nba (coach|player|roster) statistics start([\\s\\S]+?)\\{\\{s-end\\}\\}/gi, function (tmpl, name) {\n    tmpl = tmpl.replace(/^\\{\\{.*?\\}\\}/, '');\n    tmpl = tmpl.replace(/\\{\\{s-end\\}\\}/, '');\n    name = name.toLowerCase().trim();\n    var headers = '! ' + keys[name].join(' !! ');\n    var table = '{|\\n' + headers + '\\n' + tmpl + '\\n|}';\n    var rows = tableParser(table);\n    rows = rows.map(function (row) {\n      Object.keys(row).forEach(function (k) {\n        row[k] = row[k].text();\n      });\n      return row;\n    });\n    section.templates.push({\n      template: 'NBA ' + name + ' statistics',\n      data: rows\n    });\n    return '';\n  });\n  return wiki;\n};\n\nmodule.exports = parseNBA;","map":null,"metadata":{},"sourceType":"script"}