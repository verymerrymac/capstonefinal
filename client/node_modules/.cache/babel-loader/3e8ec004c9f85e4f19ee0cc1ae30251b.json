{"ast":null,"code":"var parseTemplates = require('../../templates'); //this is a non-traditional template, for some reason\n//https://en.wikipedia.org/wiki/Template:Election_box\n\n\nvar parseElection = function parseElection(wiki, section) {\n  wiki = wiki.replace(/\\{\\{election box begin([\\s\\S]+?)\\{\\{election box end\\}\\}/gi, function (tmpl) {\n    var data = {\n      templates: []\n    }; //put it through our full template parser..\n\n    parseTemplates(tmpl, data, {}); //okay, pull it apart into something sensible..\n\n    var start = data.templates.find(function (t) {\n      return t.template === 'election box';\n    }) || {};\n    var candidates = data.templates.filter(function (t) {\n      return t.template === 'election box candidate';\n    });\n    var summary = data.templates.find(function (t) {\n      return t.template === 'election box gain' || t.template === 'election box hold';\n    }) || {};\n\n    if (candidates.length > 0 || summary) {\n      section.templates.push({\n        template: 'election box',\n        title: start.title,\n        candidates: candidates,\n        summary: summary.data\n      });\n    } //remove it all\n\n\n    return '';\n  });\n  return wiki;\n};\n\nmodule.exports = parseElection;","map":null,"metadata":{},"sourceType":"script"}