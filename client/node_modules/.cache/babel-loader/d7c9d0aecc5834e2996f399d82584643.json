{"ast":null,"code":"var Document = require('./Document');\n\nvar redirects = require('./redirects');\n\nvar disambig = require('./disambig');\n\nvar preProcess = require('./preProcess');\n\nvar parse = {\n  section: require('../02-section'),\n  categories: require('./categories')\n}; //convert wikiscript markup lang to json\n\nvar main = function main(wiki, options) {\n  options = options || {};\n  wiki = wiki || '';\n  var data = {\n    type: 'page',\n    title: '',\n    sections: [],\n    categories: [],\n    coordinates: []\n  }; //detect if page is just redirect, and return it\n\n  if (redirects.isRedirect(wiki) === true) {\n    data.type = 'redirect';\n    data.redirectTo = redirects.parse(wiki);\n    parse.categories(data, wiki);\n    return new Document(data, options);\n  } //detect if page is just disambiguator page, and return\n\n\n  if (disambig.isDisambig(wiki) === true) {\n    data.type = 'disambiguation';\n  }\n\n  if (options.page_identifier) {\n    data.page_identifier = options.page_identifier;\n  }\n\n  if (options.lang_or_wikiid) {\n    data.lang_or_wikiid = options.lang_or_wikiid;\n  } //give ourselves a little head-start\n\n\n  wiki = preProcess(data, wiki, options); //pull-out [[category:whatevers]]\n\n  wiki = parse.categories(data, wiki); //parse all the headings, and their texts/sentences\n\n  data.sections = parse.section(wiki, options) || []; //all together now\n\n  return new Document(data, options);\n};\n\nmodule.exports = main;","map":null,"metadata":{},"sourceType":"script"}